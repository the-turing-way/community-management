name: Create Monthly Newsletter Management Issue

on:
  schedule:
    - cron: "0 9 1 * *"  # At 09:00 UTC on the 1st of each month
  workflow_dispatch:      # Optional manual trigger

jobs:
  create_issue:
    runs-on: ubuntu-latest
    permissions:
      issues: write  # Needed to create issues with the default GITHUB_TOKEN

    steps:
      - name: Newsletter Monthly Management Issue 
        run: |
          gh issue create \
            --repo ${{ github.repository }} \
            --title "üìÖ Newsletter planning and management issue‚Äî $(date --date="+2 months" +"%B %Y")" \
            --body "This is your automatic monthly issue to manage TTW newsletter! üõ†Ô∏è

          Things to review this month:
          - [ ] Who's owning newsletter management this month? Assign yourself!  
          - [ ] Check if issue is open on Newsletter repo to Collate content over the month: https://github.com/the-turing-way/newsletter and link below !!!
          - [ ] Move content to Buttondown or [this template](https://github.com/the-turing-way/newsletter/blob/main/newsletter-template.md)
          - [ ] Send email from gmail account
          - [ ] Archive newsletter content in [Newsletter repo] (https://github.com/the-turing-way/newsletter) and close this issue and the one in that repo! Follow the instructions below:
            - [ ] In Buttondown, instead of viewing the file in'fancy mode', change to markdown mode and copy all the content.
            - [ ] In the [Newsletter repo] (https://github.com/the-turing-way/newsletter), add a new file, name it following the convention (newsletter_X_MonthYear.md). 
            - md extension is important for the file to look nice in the preview mode!
            - Month in the naming correlates to the month of the content/planning issue, not when it's been published (we normally publish the newsletter at the end of the month or at the beg on the next one)
          
          

          _This issue was automatically generated by GitHub Actions._" \
           
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
